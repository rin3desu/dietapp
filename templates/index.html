<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>ダイエット記録アプリ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src = "https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>体重記録フォーム</h1>

    <form method = "POST" action="/">
        <label for="date">日付: </label>
        <input type="date" id="date" name="date" required><br><br>
        <label for = "weight">体重(kg) : </label>
        <input type ="number" step="0.1" id="weight" name="weight" required><br><br>
        <button type = "submit">送信</button>
    </form>

    <h2>体重記録　一覧</h2>
    <canvas id ="weightChart" width="400" height="200"></canvas>
    <table border="1">
        <tr> 
            <th>日付</th>
            <th>体重(kg) </th>
        </tr>

        {% for record in records %}

        <tr>
            <td> {{record[0] }} </td>
            <td> {{record[1] }} </td>
        </tr>
        {% endfor %}
    </table>
</body>
</html>

<script>
    const ctx = document.getElementById('weightChart').getContext('2d');
    const weightChart = new Chart(ctx,{
        type: 'line',
        data:{
            labels: {{ dates | tojson }},
            datasets:[{
                label: '体重の推移',
                data: {{weights | tojson}},
                borderColor: 'rgba(75, 192,192, 1)',
                backgroundColor: 'rgba(75,192,192, 0.2)',
                fill: false,
                tension: 0.1
            }]
        },

        options: {
            responsive: true,
            scales:{
                x: {
                    title:{
                        display : true,
                        text: '日付'
                    }
                },

                y:{
                    title: {
                        display: true,
                        text: '体重(kg)'
                    },
                    beginAtZero: false
                }
            }
        }
    });
</script>